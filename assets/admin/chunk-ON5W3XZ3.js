import{a as ei}from"./chunk-5TKBH2EH.js";import{a as ii}from"./chunk-7XZ66E5Q.js";import{d as Q,f as W,g as Y,h as Z}from"./chunk-CIAYRUPY.js";import{a as j,b as B,c as R,m as J,n as P,o as k,p as q,q as H,t as K}from"./chunk-53LNINAL.js";import{g as T,h as M,l as X,n as G,o as L,s as A}from"./chunk-TEFF5QW5.js";import{Kb as l,Lb as p,Ma as b,Mb as c,N,Nb as z,Ob as h,Sc as O,Tc as V,Vb as U,Zc as w,ba as y,bd as x,dc as v,ea as f,gb as m,hb as u,lc as $,o as _,pc as I,qc as g,rb as E,ta as D,u as C,wb as s,yb as n}from"./chunk-KXMLQHF5.js";function ti(i,e){if(i&1&&c(0,"nz-option",9),i&2){let t=e.$implicit;n("nzValue",t.id)("nzLabel",t.fullName+" "+t.email+" "+t.phone)}}function ni(i,e){if(i&1&&(z(0),s(1,ti,1,2,"nz-option",8),h()),i&2){let t=e.$implicit;m(),n("ngForOf",t.data)}}function oi(i,e){if(i&1&&c(0,"nz-option",9),i&2){let t=e.$implicit;n("nzValue",t.id)("nzLabel",t.domain)}}function ri(i,e){if(i&1&&(z(0),s(1,oi,1,2,"nz-option",8),h()),i&2){let t=e.$implicit;m(),n("ngForOf",t)}}function ai(i,e){if(i&1&&(l(0,"div",2)(1,"nz-form-item")(2,"nz-form-label",10),v(3,"Domain"),p(),l(4,"nz-form-control",4)(5,"nz-select",11),s(6,ri,2,1,"ng-container",6),I(7,"async"),p()()()()),i&2){let t=U();m(2),n("nzSm",10)("nzXs",24),m(2),n("nzSm",14)("nzXs",24)("nzErrorTip",t.formErrors.domainId),m(2),n("ngIf",g(7,6,t.domain$))}}var bi=(()=>{let e=class e extends Q{constructor(r,o){super(),this.user=r,this.domain=o,this.filter=new b,this.domainInput=!0,this.firstUser=!0,this.user$=this.user.getAllUser(1e3).pipe(f(a=>{this.firstUser&&a.data.length>0&&this.validateForm.get("userId")?.setValue(a.data[0]?.id)})),this.loadDomain$=new _,this.domain$=this.loadDomain$.pipe(y(a=>a?this.domain.allUserDomain(a).pipe(f(F=>{let S=this.validateForm.get("domainId")?.value;S&&!F.find(d=>d.id===S)?this.validateForm.get("domainId")?.setValue(""):this.domainId&&F.find(d=>d.id===this.domainId)&&this.validateForm.get("domainId")?.setValue(this.domainId),this.filter.next(this.validateForm.value)})):C([])))}ngOnInit(){this.validateForm=this.fb.group({domainId:[this.domainId],userId:[""]});let r;this.valueSubscription=this.validateForm.valueChanges.pipe(N(100)).subscribe(o=>{JSON.stringify(o)!==JSON.stringify(r)&&((!r||r.userId!==o.userId)&&this.loadDomain$.next(o.userId),r=o,this.filter.next(o))}),this.domainId&&(r=this.validateForm.value,this.filter.next(r)),this.defaultValue.userId&&this.loadDomain$.next(this.defaultValue.userId)}ngOnDestroy(){super.ngOnDestroy(),this.valueSubscription&&this.valueSubscription.unsubscribe()}};e.\u0275fac=function(o){return new(o||e)(u(ii),u(ei))},e.\u0275cmp=D({type:e,selectors:[["app-user-domain-filter"]],inputs:{domainInput:"domainInput",domainId:"domainId",firstUser:"firstUser"},outputs:{filter:"filter"},standalone:!0,features:[E,$],decls:11,vars:10,consts:[["nz-form","",3,"formGroup"],["nz-row","","nzGutter","20"],["nz-col","","nzSpan","12"],["nzFor","userId",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzErrorTip"],["formControlName","userId","nzShowSearch","","nzAllowClear",""],[4,"ngIf"],["nz-col","","nzSpan","12",4,"ngIf"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],["nzFor","domainId",3,"nzSm","nzXs"],["formControlName","domainId","nzShowSearch","","nzAllowClear",""]],template:function(o,a){o&1&&(l(0,"form",0)(1,"div",1)(2,"div",2)(3,"nz-form-item")(4,"nz-form-label",3),v(5,"User"),p(),l(6,"nz-form-control",4)(7,"nz-select",5),s(8,ni,2,1,"ng-container",6),I(9,"async"),p()()()(),s(10,ai,8,8,"div",7),p()()),o&2&&(n("formGroup",a.validateForm),m(4),n("nzSm",10)("nzXs",24),m(2),n("nzSm",14)("nzXs",24)("nzErrorTip",a.formErrors.userId),m(2),n("ngIf",g(9,8,a.user$)),m(2),n("ngIf",a.domainInput))},dependencies:[H,B,j,P,J,q,k,R,K,A,X,T,M,G,L,Z,W,Y,x,O,V,w]});let i=e;return i})();export{bi as a};
