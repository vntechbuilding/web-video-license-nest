import{a as Pe}from"./chunk-ASNUN4YP.js";import{a as Ne}from"./chunk-YANWLB2B.js";import{a as ke,b as De,c as Le,q as Qe,r as je,t as Ye}from"./chunk-53LNINAL.js";import{a as Oe,h as Te,n as He,s as Ve,t as Be,u as Fe,w as We,x as Ue}from"./chunk-TEFF5QW5.js";import{Ba as Xe}from"./chunk-E7AKRIK7.js";import{h as Ee,i as q}from"./chunk-3D2PYGCY.js";import{$b as te,Ab as X,Ac as Re,Da as _e,E as k,Ea as g,Fa as d,H as J,Kb as f,Lb as m,Ma as H,Mb as y,Nb as ye,Ob as Ae,Qb as U,Tb as x,Tc as N,U as ge,Vb as l,Zb as ee,a as b,ac as ie,b as me,bc as re,bd as G,ca as de,cb as F,dc as P,eb as Ce,ec as ve,f as I,gb as _,gc as be,ha as fe,hb as z,ia as j,ja as ue,kc as Ie,lc as Se,pb as Me,rb as we,ta as Y,ua as xe,wb as E,xb as Z,yb as w,zb as W,zc as ze}from"./chunk-KXMLQHF5.js";var nt=["wrapper"],ot=["sourceImage"];function st(o,s){if(o&1){let e=U();f(0,"img",5,1),x("load",function(){g(e);let i=l();return d(i.imageLoadedInView())})("mousedown",function(i){g(e);let r=l();return d(r.startMove(i,r.moveTypes.Drag))})("touchstart",function(i){g(e);let r=l();return d(r.startMove(i,r.moveTypes.Drag))})("error",function(i){g(e);let r=l();return d(r.loadImageError(i))}),m()}if(o&2){let e=l();W("visibility",e.imageVisible?"visible":"hidden")("transform",e.safeTransformStyle),X("ngx-ic-draggable",!e.disabled&&e.allowMoveImage),w("src",e.safeImgDataUrl,F),Z("alt",e.imageAltText)}}function ct(o,s){if(o&1){let e=U();ye(0),f(1,"span",9),x("mousedown",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"topleft"))})("touchstart",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"topleft"))}),y(2,"span",10),m(),f(3,"span",11),y(4,"span",10),m(),f(5,"span",12),x("mousedown",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"topright"))})("touchstart",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"topright"))}),y(6,"span",10),m(),f(7,"span",13),y(8,"span",10),m(),f(9,"span",14),x("mousedown",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"bottomright"))})("touchstart",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"bottomright"))}),y(10,"span",10),m(),f(11,"span",15),y(12,"span",10),m(),f(13,"span",16),x("mousedown",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"bottomleft"))})("touchstart",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"bottomleft"))}),y(14,"span",10),m(),f(15,"span",17),y(16,"span",10),m(),f(17,"span",18),x("mousedown",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"top"))})("touchstart",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"top"))}),m(),f(18,"span",19),x("mousedown",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"right"))})("touchstart",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"right"))}),m(),f(19,"span",20),x("mousedown",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"bottom"))})("touchstart",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"bottom"))}),m(),f(20,"span",21),x("mousedown",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"left"))})("touchstart",function(i){g(e);let r=l(2);return d(r.startMove(i,r.moveTypes.Resize,"left"))}),m(),Ae()}}function ht(o,s){if(o&1){let e=U();f(0,"div",6),x("keydown",function(i){g(e);let r=l();return d(r.keyboardAccess(i))}),f(1,"div",7),x("mousedown",function(i){g(e);let r=l();return d(r.startMove(i,r.moveTypes.Move))})("touchstart",function(i){g(e);let r=l();return d(r.startMove(i,r.moveTypes.Move))}),m(),E(2,ct,21,0,"ng-container",8),m()}if(o&2){let e=l();W("top",e.cropper.y1,"px")("left",e.cropper.x1,"px")("width",e.cropper.x2-e.cropper.x1,"px")("height",e.cropper.y2-e.cropper.y1,"px")("margin-left",e.alignImage==="center"?e.marginLeft:null)("visibility",e.imageVisible?"visible":"hidden"),X("ngx-ic-round",e.roundCropper),Z("aria-label",e.cropperFrameAriaLabel),_(2),w("ngIf",!e.hideResizeSquares)}}var ae=class{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperFrameAriaLabel="Crop photo",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(s){Object.keys(s).filter(e=>e in this).forEach(e=>this[e]=s[e]),this.validateOptions()}setOptionsFromChanges(s){Object.keys(s).filter(e=>e in this).forEach(e=>this[e]=s[e].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}},A=function(o){return o.Drag="drag",o.Move="move",o.Resize="resize",o.Pinch="pinch",o}(A||{});function pt(o){switch(o){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}function lt(o){switch(o){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}function mt(o,s){switch(o){case"ArrowUp":return{clientX:0,clientY:s*-1};case"ArrowRight":return{clientX:s,clientY:0};case"ArrowDown":return{clientX:0,clientY:s};case"ArrowLeft":default:return{clientX:s*-1,clientY:0}}}function gt(o,s,e){let t=o.width,i=o.height;s=Math.round(s),e=Math.round(e);let r=t/s,a=i/e,n=Math.ceil(r/2),c=Math.ceil(a/2),p=o.getContext("2d");if(p){let h=p.getImageData(0,0,t,i),u=p.createImageData(s,e),C=h.data,R=u.data;for(let O=0;O<e;O++)for(let T=0;T<s;T++){let S=(T+O*s)*4,v=O*a,M=0,D=0,ne=0,oe=0,se=0,ce=0,he=0,Je=Math.floor(T*r),Ze=Math.floor(O*a),K=Math.ceil((T+1)*r),$=Math.ceil((O+1)*a);K=Math.min(K,t),$=Math.min($,i);for(let L=Ze;L<$;L++){let pe=Math.abs(v-L)/c,et=T*r,tt=pe*pe;for(let Q=Je;Q<K;Q++){let le=Math.abs(et-Q)/n,V=Math.sqrt(tt+le*le);if(V>=1)continue;M=2*V*V*V-3*V*V+1;let B=4*(Q+L*t);he+=M*C[B+3],ne+=M,C[B+3]<255&&(M=M*C[B+3]/250),oe+=M*C[B],se+=M*C[B+1],ce+=M*C[B+2],D+=M}}R[S]=oe/D,R[S+1]=se/D,R[S+2]=ce/D,R[S+3]=he/ne}o.width=s,o.height=e,p.putImageData(u,0,0)}}function Ge(o,s){return o/100*s}var dt=(()=>{class o{crop(e,t,i,r,a){let n=this.getImagePosition(e,t,i,a),c=n.x2-n.x1,p=n.y2-n.y1,h=document.createElement("canvas");h.width=c,h.height=p;let u=h.getContext("2d");if(!u)return null;i.backgroundColor!=null&&(u.fillStyle=i.backgroundColor,u.fillRect(0,0,c,p));let C=(i.transform.scale||1)*(i.transform.flipH?-1:1),R=(i.transform.scale||1)*(i.transform.flipV?-1:1),{translateH:O,translateV:T}=this.getCanvasTranslate(e,i,a),S=e.transformed;u.setTransform(C,0,0,R,S.size.width/2+O,S.size.height/2+T),u.translate(-n.x1/C,-n.y1/R),u.rotate((i.transform.rotate||0)*Math.PI/180),u.drawImage(S.image,-S.size.width/2,-S.size.height/2);let v={width:c,height:p,imagePosition:n,cropperPosition:b({},t)};i.containWithinAspectRatio&&(v.offsetImagePosition=this.getOffsetImagePosition(e,t,i,a));let M=this.getResizeRatio(c,p,i);return M!==1&&(v.width=Math.round(c*M),v.height=i.maintainAspectRatio?Math.round(v.width/i.aspectRatio):Math.round(p*M),gt(h,v.width,v.height)),r==="blob"?this.cropToBlob(v,h,i):(v.base64=h.toDataURL("image/"+i.format,this.getQuality(i)),v)}cropToBlob(e,t,i){return I(this,null,function*(){return e.blob=yield new Promise(r=>t.toBlob(r,"image/"+i.format,this.getQuality(i))),e.blob&&(e.objectUrl=URL.createObjectURL(e.blob)),e})}getCanvasTranslate(e,t,i){if(t.transform.translateUnit==="px"){let r=this.getRatio(e,i);return{translateH:(t.transform.translateH||0)*r,translateV:(t.transform.translateV||0)*r}}else return{translateH:t.transform.translateH?Ge(t.transform.translateH,e.transformed.size.width):0,translateV:t.transform.translateV?Ge(t.transform.translateV,e.transformed.size.height):0}}getRatio(e,t){return e.transformed.size.width/t.width}getImagePosition(e,t,i,r){let a=this.getRatio(e,r),n={x1:Math.round(t.x1*a),y1:Math.round(t.y1*a),x2:Math.round(t.x2*a),y2:Math.round(t.y2*a)};return i.containWithinAspectRatio||(n.x1=Math.max(n.x1,0),n.y1=Math.max(n.y1,0),n.x2=Math.min(n.x2,e.transformed.size.width),n.y2=Math.min(n.y2,e.transformed.size.height)),n}getOffsetImagePosition(e,t,i,r){let a=i.canvasRotation+e.exifTransform.rotate,n=this.getRatio(e,r),c,p;a%2?(c=(e.transformed.size.width-e.original.size.height)/2,p=(e.transformed.size.height-e.original.size.width)/2):(c=(e.transformed.size.width-e.original.size.width)/2,p=(e.transformed.size.height-e.original.size.height)/2);let h={x1:Math.round(t.x1*n)-c,y1:Math.round(t.y1*n)-p,x2:Math.round(t.x2*n)-c,y2:Math.round(t.y2*n)-p};return i.containWithinAspectRatio||(h.x1=Math.max(h.x1,0),h.y1=Math.max(h.y1,0),h.x2=Math.min(h.x2,e.transformed.size.width),h.y2=Math.min(h.y2,e.transformed.size.height)),h}getResizeRatio(e,t,i){let r=i.resizeToWidth/e,a=i.resizeToHeight/t,n=new Array;i.resizeToWidth>0&&n.push(r),i.resizeToHeight>0&&n.push(a);let c=n.length===0?1:Math.min(...n);return c>1&&!i.onlyScaleDown?c:Math.min(c,1)}getQuality(e){return Math.min(1,Math.max(0,e.imageQuality/100))}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=j({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),ft=(()=>{class o{resetCropperPosition(e,t,i,r){if(e?.nativeElement)if(i.cropperStaticHeight&&i.cropperStaticWidth)t.x1=0,t.x2=r.width>i.cropperStaticWidth?i.cropperStaticWidth:r.width,t.y1=0,t.y2=r.height>i.cropperStaticHeight?i.cropperStaticHeight:r.height;else{let a=Math.min(i.cropperScaledMaxWidth,r.width),n=Math.min(i.cropperScaledMaxHeight,r.height);if(!i.maintainAspectRatio)t.x1=0,t.x2=a,t.y1=0,t.y2=n;else if(r.width/i.aspectRatio<r.height){t.x1=0,t.x2=a;let c=a/i.aspectRatio;t.y1=(r.height-c)/2,t.y2=t.y1+c}else{t.y1=0,t.y2=n;let c=n*i.aspectRatio;t.x1=(r.width-c)/2,t.x2=t.x1+c}}}move(e,t,i){let r=this.getClientX(e)-t.clientX,a=this.getClientY(e)-t.clientY;i.x1=t.x1+r,i.y1=t.y1+a,i.x2=t.x2+r,i.y2=t.y2+a}resize(e,t,i,r,a){let n=this.getClientX(e)-t.clientX,c=this.getClientY(e)-t.clientY;switch(t.position){case"left":i.x1=Math.min(Math.max(t.x1+n,i.x2-a.cropperScaledMaxWidth),i.x2-a.cropperScaledMinWidth);break;case"topleft":i.x1=Math.min(Math.max(t.x1+n,i.x2-a.cropperScaledMaxWidth),i.x2-a.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+c,i.y2-a.cropperScaledMaxHeight),i.y2-a.cropperScaledMinHeight);break;case"top":i.y1=Math.min(Math.max(t.y1+c,i.y2-a.cropperScaledMaxHeight),i.y2-a.cropperScaledMinHeight);break;case"topright":i.x2=Math.max(Math.min(t.x2+n,i.x1+a.cropperScaledMaxWidth),i.x1+a.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+c,i.y2-a.cropperScaledMaxHeight),i.y2-a.cropperScaledMinHeight);break;case"right":i.x2=Math.max(Math.min(t.x2+n,i.x1+a.cropperScaledMaxWidth),i.x1+a.cropperScaledMinWidth);break;case"bottomright":i.x2=Math.max(Math.min(t.x2+n,i.x1+a.cropperScaledMaxWidth),i.x1+a.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+c,i.y1+a.cropperScaledMaxHeight),i.y1+a.cropperScaledMinHeight);break;case"bottom":i.y2=Math.max(Math.min(t.y2+c,i.y1+a.cropperScaledMaxHeight),i.y1+a.cropperScaledMinHeight);break;case"bottomleft":i.x1=Math.min(Math.max(t.x1+n,i.x2-a.cropperScaledMaxWidth),i.x2-a.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+c,i.y1+a.cropperScaledMaxHeight),i.y1+a.cropperScaledMinHeight);break;case"center":let p=e.scale,h=Math.min(Math.max(a.cropperScaledMinWidth,Math.abs(t.x2-t.x1)*p),a.cropperScaledMaxWidth),u=Math.min(Math.max(a.cropperScaledMinHeight,Math.abs(t.y2-t.y1)*p),a.cropperScaledMaxHeight);i.x1=t.clientX-h/2,i.x2=t.clientX+h/2,i.y1=t.clientY-u/2,i.y2=t.clientY+u/2,i.x1<0?(i.x2-=i.x1,i.x1=0):i.x2>r.width&&(i.x1-=i.x2-r.width,i.x2=r.width),i.y1<0?(i.y2-=i.y1,i.y1=0):i.y2>r.height&&(i.y1-=i.y2-r.height,i.y2=r.height);break}a.maintainAspectRatio&&this.checkAspectRatio(t.position,i,r,a)}checkAspectRatio(e,t,i,r){let a=0,n=0;switch(e){case"top":t.x2=t.x1+(t.y2-t.y1)*r.aspectRatio,a=Math.max(t.x2-i.width,0),n=Math.max(0-t.y1,0),(a>0||n>0)&&(t.x2-=n*r.aspectRatio>a?n*r.aspectRatio:a,t.y1+=n*r.aspectRatio>a?n:a/r.aspectRatio);break;case"bottom":t.x2=t.x1+(t.y2-t.y1)*r.aspectRatio,a=Math.max(t.x2-i.width,0),n=Math.max(t.y2-i.height,0),(a>0||n>0)&&(t.x2-=n*r.aspectRatio>a?n*r.aspectRatio:a,t.y2-=n*r.aspectRatio>a?n:a/r.aspectRatio);break;case"topleft":t.y1=t.y2-(t.x2-t.x1)/r.aspectRatio,a=Math.max(0-t.x1,0),n=Math.max(0-t.y1,0),(a>0||n>0)&&(t.x1+=n*r.aspectRatio>a?n*r.aspectRatio:a,t.y1+=n*r.aspectRatio>a?n:a/r.aspectRatio);break;case"topright":t.y1=t.y2-(t.x2-t.x1)/r.aspectRatio,a=Math.max(t.x2-i.width,0),n=Math.max(0-t.y1,0),(a>0||n>0)&&(t.x2-=n*r.aspectRatio>a?n*r.aspectRatio:a,t.y1+=n*r.aspectRatio>a?n:a/r.aspectRatio);break;case"right":case"bottomright":t.y2=t.y1+(t.x2-t.x1)/r.aspectRatio,a=Math.max(t.x2-i.width,0),n=Math.max(t.y2-i.height,0),(a>0||n>0)&&(t.x2-=n*r.aspectRatio>a?n*r.aspectRatio:a,t.y2-=n*r.aspectRatio>a?n:a/r.aspectRatio);break;case"left":case"bottomleft":t.y2=t.y1+(t.x2-t.x1)/r.aspectRatio,a=Math.max(0-t.x1,0),n=Math.max(t.y2-i.height,0),(a>0||n>0)&&(t.x1+=n*r.aspectRatio>a?n*r.aspectRatio:a,t.y2-=n*r.aspectRatio>a?n:a/r.aspectRatio);break;case"center":t.x2=t.x1+(t.y2-t.y1)*r.aspectRatio,t.y2=t.y1+(t.x2-t.x1)/r.aspectRatio;let c=Math.max(0-t.x1,0),p=Math.max(t.x2-i.width,0),h=Math.max(t.y2-i.height,0),u=Math.max(0-t.y1,0);(c>0||p>0||h>0||u>0)&&(t.x1+=h*r.aspectRatio>c?h*r.aspectRatio:c,t.x2-=u*r.aspectRatio>p?u*r.aspectRatio:p,t.y1+=u*r.aspectRatio>p?u:p/r.aspectRatio,t.y2-=h*r.aspectRatio>c?h:c/r.aspectRatio);break}}getClientX(e){return e.touches?.[0].clientX||e.clientX||0}getClientY(e){return e.touches?.[0].clientY||e.clientY||0}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=j({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),ut="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==";function xt(){return new Promise(o=>{let s=new Image;s.onload=()=>{let e=s.width===1&&s.height===2;o(e)},s.src=ut})}function _t(o){switch(typeof o=="object"&&(o=Ct(o)),o){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}function Ct(o){let s=new DataView(o);if(s.getUint16(0,!1)!==65496)return-2;let e=s.byteLength,t=2;for(;t<e;){if(s.getUint16(t+2,!1)<=8)return-1;let i=s.getUint16(t,!1);if(t+=2,i==65505){if(s.getUint32(t+=2,!1)!==1165519206)return-1;let r=s.getUint16(t+=6,!1)==18761;t+=s.getUint32(t+4,r);let a=s.getUint16(t,r);t+=2;for(let n=0;n<a;n++)if(s.getUint16(t+n*12,r)==274)return s.getUint16(t+n*12+8,r)}else{if((i&65280)!==65280)break;t+=s.getUint16(t,!1)}}return-1}var Mt=(()=>{class o{constructor(){this.autoRotateSupported=xt()}loadImageFile(e,t){return I(this,null,function*(){let i=yield e.arrayBuffer();return yield this.checkImageTypeAndLoadImageFromArrayBuffer(i,e.type,t)})}checkImageTypeAndLoadImageFromArrayBuffer(e,t,i){return this.isValidImageType(t)?this.loadImageFromArrayBuffer(e,i,t):Promise.reject(new Error("Invalid image type"))}isValidImageType(e){return/image\/(png|jpg|jpeg|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(e)}loadImageFromURL(e,t){return I(this,null,function*(){let r=yield(yield fetch(e)).blob(),a=yield r.arrayBuffer();return yield this.loadImageFromArrayBuffer(a,t,r.type)})}loadBase64Image(e,t){let i=this.base64ToArrayBuffer(e);return this.loadImageFromArrayBuffer(i,t)}base64ToArrayBuffer(e){e=e.replace(/^data:([^;]+);base64,/gmi,"");let t=atob(e),i=t.length,r=new Uint8Array(i);for(let a=0;a<i;a++)r[a]=t.charCodeAt(a);return r.buffer}loadImageFromArrayBuffer(e,t,i){return I(this,null,function*(){let r=yield new Promise((a,n)=>I(this,null,function*(){try{let c=new Blob([e],i?{type:i}:void 0),p=URL.createObjectURL(c),h=new Image,C=i==="image/svg+xml"?yield this.getSvgImageSize(c):void 0;h.onload=()=>a({originalImage:h,originalImageSize:C,originalObjectUrl:p,originalArrayBuffer:e}),h.onerror=n,h.src=p}catch(c){n(c)}}));return yield this.transformImageFromArrayBuffer(r,t,r.originalImageSize!=null)})}getSvgImageSize(e){return I(this,null,function*(){let r=new DOMParser().parseFromString(yield e.text(),"image/svg+xml").querySelector("svg");if(!r)throw Error("Failed to parse SVG image");let a=r.getAttribute("width"),n=r.getAttribute("height");if(a&&n)return null;let c=r.getAttribute("viewBox")||r.getAttribute("viewbox");if(c){let p=c.split(" ");return{width:+p[2],height:+p[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})}transformImageFromArrayBuffer(e,t,i=!1){return I(this,null,function*(){let r=yield this.autoRotateSupported,a=_t(r?-1:e.originalArrayBuffer);if(!e.originalImage||!e.originalImage.complete)return Promise.reject(new Error("No image loaded"));let n={original:{objectUrl:e.originalObjectUrl,image:e.originalImage,size:e.originalImageSize??{width:e.originalImage.naturalWidth,height:e.originalImage.naturalHeight}},exifTransform:a};return this.transformLoadedImage(n,t,i)})}transformLoadedImage(e,t,i=!1){return I(this,null,function*(){let r=t.canvasRotation+e.exifTransform.rotate,a=e.original.size;if(!i&&r===0&&!e.exifTransform.flip&&!t.containWithinAspectRatio)return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:b({},a)},transformed:{objectUrl:e.original.objectUrl,image:e.original.image,size:b({},a)},exifTransform:e.exifTransform};let n=this.getTransformedSize(a,e.exifTransform,t),c=document.createElement("canvas");c.width=n.width,c.height=n.height;let p=c.getContext("2d");p?.setTransform(e.exifTransform.flip?-1:1,0,0,1,c.width/2,c.height/2),p?.rotate(Math.PI*(r/2)),p?.drawImage(e.original.image,-a.width/2,-a.height/2);let h=yield new Promise(R=>c.toBlob(R,t.format));if(!h)throw new Error("Failed to get Blob for transformed image.");let u=URL.createObjectURL(h),C=yield this.loadImageFromObjectUrl(u);return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:b({},a)},transformed:{objectUrl:u,image:C,size:{width:C.width,height:C.height}},exifTransform:e.exifTransform}})}loadImageFromObjectUrl(e){return new Promise((t,i)=>{let r=new Image;r.onload=()=>t(r),r.onerror=i,r.src=e})}getTransformedSize(e,t,i){let r=i.canvasRotation+t.rotate;if(i.containWithinAspectRatio)if(r%2){let a=e.width*i.aspectRatio,n=e.height/i.aspectRatio;return{width:Math.max(e.height,a),height:Math.max(e.width,n)}}else{let a=e.height*i.aspectRatio,n=e.width/i.aspectRatio;return{width:Math.max(e.width,a),height:Math.max(e.height,n)}}return r%2?{height:e.width,width:e.height}:{width:e.width,height:e.height}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=j({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),qe=(()=>{class o{constructor(e,t,i,r,a,n,c){this.cropService=e,this.cropperPositionService=t,this.loadImageService=i,this.sanitizer=r,this.cd=a,this.zone=n,this.hammerLoader=c,this.settings=new ae,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=A,this.imageVisible=!1,this.cropperFrameAriaLabel=this.settings.cropperFrameAriaLabel,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new H,this.startCropImage=new H,this.imageLoaded=new H,this.cropperReady=new H,this.loadImageFailed=new H,this.transformChange=new H,this.reset()}ngOnChanges(e){this.onChangesUpdateSettings(e),this.onChangesInputImage(e),this.loadedImage?.original.image.complete&&(e.containWithinAspectRatio||e.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t)),(e.cropper||e.maintainAspectRatio||e.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(this.resetCropOnAspectRatioChange||!this.aspectRatioIsCorrect())&&(e.maintainAspectRatio||e.aspectRatio)?this.resetCropperPosition():e.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop())),e.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop()),e.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(e){this.settings.setOptionsFromChanges(e),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&(this.hideResizeSquares=!0,this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1}))}onChangesInputImage(e){(e.imageChangedEvent||e.imageURL||e.imageBase64||e.imageFile)&&this.reset(),e.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),e.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),e.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),e.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){let e=this.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${e}, ${this.transform.translateV||0}${e}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(e){this.loadImageService.loadImageFile(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadBase64Image(e){this.loadImageService.loadBase64Image(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadImageFromURL(e){this.loadImageService.loadImageFromURL(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}setLoadedImage(e){this.loadedImage=e,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e.transformed.objectUrl),this.cd.markForCheck()}loadImageError(e){console.error(e),this.loadImageFailed.emit()}imageLoadedInView(){this.loadedImage!=null&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(b({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){if(this.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{let e=b({},this.maxSize);this.setMaxSize(),this.resizeCropperPosition(e),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}}activatePinchGesture(){return I(this,null,function*(){yield this.hammerLoader?.();let e=window?.Hammer||null;if(e){let t=new e(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else ze()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})}resizeCropperPosition(e){(e.width!==this.maxSize.width||e.height!==this.maxSize.height)&&(this.cropper.x1=this.cropper.x1*this.maxSize.width/e.width,this.cropper.x2=this.cropper.x2*this.maxSize.width/e.width,this.cropper.y1=this.cropper.y1*this.maxSize.height/e.height,this.cropper.y2=this.cropper.y2*this.maxSize.height/e.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings,this.maxSize),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(e){this.changeKeyboardStepSize(e),this.keyboardMoveCropper(e)}changeKeyboardStepSize(e){let t=+e.key;t>=1&&t<=9&&(this.settings.stepSize=t)}keyboardMoveCropper(e){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e.key))return;let i=e.shiftKey?A.Resize:A.Move,r=e.altKey?lt(e.key):pt(e.key),a=mt(e.key,this.settings.stepSize);e.preventDefault(),e.stopPropagation(),this.startMove({clientX:0,clientY:0},i,r),this.handleMouseMove(a),this.handleMouseUp()}startMove(e,t,i=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===A.Pinch||t===A.Drag&&!this.allowMoveImage||(e.preventDefault&&e.preventDefault(),this.moveStart=b({active:!0,type:t,position:i,transform:b({},this.transform),clientX:this.cropperPositionService.getClientX(e),clientY:this.cropperPositionService.getClientY(e)},this.cropper),this.initMouseMove())}initMouseMove(){J(k(document,"mousemove"),k(document,"touchmove")).pipe(de(J(k(document,"mouseup"),k(document,"touchend")).pipe(ge()))).subscribe({next:e=>this.zone.run(()=>{this.handleMouseMove(e),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}startPinch(e){this.safeImgDataUrl&&(e.preventDefault&&e.preventDefault(),this.moveStart=b({active:!0,type:A.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}handleMouseMove(e){if(this.moveStart.active){if(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.moveStart.type===A.Move)this.cropperPositionService.move(e,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===A.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===A.Drag){let t=this.cropperPositionService.getClientX(e)-this.moveStart.clientX,i=this.cropperPositionService.getClientY(e)-this.moveStart.clientY;this.transform=me(b({},this.transform),{translateH:(this.moveStart.transform?.translateH||0)+t,translateV:(this.moveStart.transform?.translateV||0)+i}),this.setCssTransform()}}}onPinch(e){this.moveStart.active&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.moveStart.type===A.Pinch&&(this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.markForCheck())}setMaxSize(){if(this.sourceImage){let e=getComputedStyle(this.sourceImage.nativeElement);this.maxSize.width=parseFloat(e.width),this.maxSize.height=parseFloat(e.height),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.maintainAspectRatio?this.settings.cropperScaledMinHeight=Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?this.settings.cropperScaledMinHeight=Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):this.settings.cropperScaledMinHeight=20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){let e=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/e:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/e:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(e=!1){this.cropper.x1<0&&(this.cropper.x2-=e?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=e?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=e?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=e?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}handleMouseUp(){this.moveStart.active&&(this.moveStart.active=!1,this.moveStart?.type===A.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(e=this.settings.output){if(this.loadedImage?.transformed?.image!=null){if(this.startCropImage.emit(),e==="blob")return this.cropToBlob();if(e==="base64")return this.cropToBase64()}return null}cropToBlob(){return new Promise((e,t)=>this.zone.run(()=>I(this,null,function*(){let i=yield this.cropService.crop(this.loadedImage,this.cropper,this.settings,"blob",this.maxSize);i?(this.imageCropped.emit(i),e(i)):t("Crop image failed")})))}cropToBase64(){let e=this.cropService.crop(this.loadedImage,this.cropper,this.settings,"base64",this.maxSize);return e?(this.imageCropped.emit(e),e):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return o.\u0275fac=function(e){return new(e||o)(z(dt),z(ft),z(Mt),z(q),z(Re),z(Me),z(Ee,8))},o.\u0275cmp=Y({type:o,selectors:[["image-cropper"]],viewQuery:function(e,t){if(e&1&&(te(nt,7),te(ot,5)),e&2){let i;ie(i=re())&&(t.wrapper=i.first),ie(i=re())&&(t.sourceImage=i.first)}},hostVars:6,hostBindings:function(e,t){e&1&&x("resize",function(){return t.onResize()},!1,Ce),e&2&&(W("text-align",t.alignImage),X("disabled",t.disabled)("ngx-ix-hidden",t.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},features:[_e],decls:5,vars:10,consts:[["wrapper",""],["sourceImage",""],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(e,t){e&1&&(f(0,"div",null,0),E(2,st,2,8,"img",2),y(3,"div",3),E(4,ht,3,16,"div",4),m()),e&2&&(W("background",t.imageVisible&&t.backgroundColor),_(2),w("ngIf",t.safeImgDataUrl),_(),W("width",t.maxSize.width,"px")("height",t.maxSize.height,"px")("margin-left",t.alignImage==="center"?t.marginLeft:null),_(),w("ngIf",t.imageVisible))},dependencies:[N],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),o})(),Ke=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=xe({type:o}),o.\u0275inj=ue({imports:[[G]]}),o})();var $e=o=>new Promise((s,e)=>{let t=new Image;t.onload=()=>s({width:t.width,height:t.height}),t.onerror=e,t.src=o});function yt(o,s){if(o&1&&(f(0,"div",11)(1,"a",12),y(2,"img",13),m()()),o&2){let e=l();_(),ee("href","",e.uploadContentImageUrl,"",e.defaultValue[e.defaultField],"",F),_(),ee("src","",e.uploadContentImageUrl,"",e.defaultValue[e.defaultField],"",F)}}function At(o,s){if(o&1){let e=U();f(0,"button",14),x("nzOnConfirm",function(){g(e);let i=l();return d(i.cancelMetaImage())}),P(1,"H\u1EE7y"),m()}}function vt(o,s){if(o&1&&(f(0,"div"),P(1),m()),o&2){let e=l(2);_(),be("Width: ",e.metaImageDimensions.width,"px / Height: ",e.metaImageDimensions.height,"px")}}function bt(o,s){if(o&1&&(f(0,"div",15),E(1,vt,2,2,"div",16),y(2,"img",17),m()),o&2){let e=l();_(),w("ngIf",e.metaImageDimensions),_(),w("src",e.croppedImage,F)}}var pi=(()=>{let s=class s extends Pe{constructor(t){super(),this.sanitizer=t,this.uploadContentImageUrl=Xe.uploadContentImageThumbnailUrl,this.label="H\xECnh \u1EA3nh",this.defaultField="image",this.aspectRatio=5/3,this.imageChangedEvent="",this.croppedImage="",this.reader=new FileReader}ngOnInit(){this.reader.onloadend=()=>{this.formGroup.get(this.defaultField)?.setValue(this.reader.result),this.metaImage=this.reader.result,$e(this.metaImage).then(t=>this.metaImageDimensions=t)},this.addControl(this.defaultField,this.setValidators(this.validators[this.defaultField],[]),"",!0)}fileChangeEvent(t){this.imageChangedEvent=t}imageCropped(t){this.croppedImage=this.sanitizer.bypassSecurityTrustUrl(t.objectUrl),this.reader.readAsDataURL(t.blob)}imageLoaded(t){}cropperReady(){}loadImageFailed(){}cancelMetaImage(){this.imageChangedEvent=null,this.croppedImage=null,this.metaImageDimensions=null,this.metaImage="",this.formGroup.get(this.defaultField)?.setValue("")}};s.\u0275fac=function(i){return new(i||s)(z(q))},s.\u0275cmp=Y({type:s,selectors:[["app-content-image-input"]],inputs:{uploadContentImageUrl:"uploadContentImageUrl",label:"label",defaultField:"defaultField",aspectRatio:"aspectRatio"},standalone:!0,features:[Ie([{provide:Oe,useExisting:fe(()=>s),multi:!0}]),we,Se],decls:14,vars:8,consts:[[3,"formGroup"],["nz-row","","nzGutter","20"],["nz-col","","nzSm","10","nzXs","24",1,"text-right"],["nz-col","","nzSm","14","nzXs","24"],["class","mb1",4,"ngIf"],["nz-input","","type","file","accept",".png,.jpg,.jpeg,.gif",3,"change"],["nz-button","","nzType","primary","nzDanger","","nzSize","small","nz-popconfirm","","nzPopconfirmTitle","Are you sure delete this task?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm",4,"ngIf"],[1,"crop-wrapper","mb1","mt1"],["nz-col","","nzSpan","7"],["format","png",3,"imageCropped","imageLoaded","cropperReady","loadImageFailed","imageChangedEvent","maintainAspectRatio","aspectRatio"],["nz-col","","nzSpan","14",4,"ngIf"],[1,"mb1"],["target","_blank",3,"href"],["alt","",2,"max-height","100px",3,"src"],["nz-button","","nzType","primary","nzDanger","","nzSize","small","nz-popconfirm","","nzPopconfirmTitle","Are you sure delete this task?","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["nz-col","","nzSpan","14"],[4,"ngIf"],[3,"src"]],template:function(i,r){i&1&&(f(0,"div",0)(1,"div",1)(2,"div",2),P(3),m(),f(4,"div",3)(5,"div"),E(6,yt,3,6,"div",4),f(7,"input",5),x("change",function(n){return r.fileChangeEvent(n)}),m(),E(8,At,2,0,"button",6),m(),f(9,"div",7)(10,"div",1)(11,"div",8)(12,"image-cropper",9),x("imageCropped",function(n){return r.imageCropped(n)})("imageLoaded",function(n){return r.imageLoaded(n)})("cropperReady",function(){return r.cropperReady()})("loadImageFailed",function(){return r.loadImageFailed()}),m()(),E(13,bt,3,2,"div",10),m()()()()()),i&2&&(w("formGroup",r.formGroup),_(3),ve(r.label),_(3),w("ngIf",r.defaultValue[r.defaultField]),_(2),w("ngIf",r.croppedImage),_(4),w("imageChangedEvent",r.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",r.aspectRatio),_(),w("ngIf",r.croppedImage))},dependencies:[Qe,De,ke,Ye,je,Le,Ve,Te,He,Ke,qe,G,N,Ue,We,Be,Fe,Ne],styles:[".crop-wrapper[_ngcontent-%COMP%]{display:inline-block;max-width:100%;width:700px}.crop-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%}"]});let o=s;return o})();export{qe as a,Ke as b,$e as c,pi as d};
